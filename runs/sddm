#!/usr/bin/env bash

script_dir="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"

# Install SDDM and theme
sudo pacman -S --noconfirm --needed sddm
paru -S --noconfirm --needed sddm-sugar-candy-git

# Apply custom theme configuration
if [ -f "$script_dir/sddm-theme.conf" ]; then
    echo "Applying custom Sugar-Candy theme configuration..."
    sudo cp "$script_dir/sddm-theme.conf" /usr/share/sddm/themes/Sugar-Candy/theme.conf
    sudo chown root:root /usr/share/sddm/themes/Sugar-Candy/theme.conf
    echo "Custom theme configuration applied."
else
    echo "Warning: sddm-theme.conf not found in $script_dir"
fi

# Create SDDM config to use Sugar-Candy theme
sudo mkdir -p /etc/sddm.conf.d
sudo tee /etc/sddm.conf.d/10-theme.conf > /dev/null <<EOF
[Theme]
Current=Sugar-Candy
CursorTheme=breeze_cursors
EOF

# Create Wayland config if needed
sudo tee /etc/sddm.conf.d/10-wayland.conf > /dev/null <<EOF
[General]
DisplayServer=wayland
EOF

echo "SDDM installation and configuration complete!"
echo "Don't forget to enable it: sudo systemctl enable sddm"
